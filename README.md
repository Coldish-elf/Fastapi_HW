# FastAPI Task Management Application
![Tests](https://github.com/Coldish-elf/Fastapi_HW/actions/workflows/ci.yml/badge.svg)
![Coverage](coverage.svg)

## Функционал проекта

- **CRUD задачи:**  
  - Создание задач с заголовком, описанием, статусом, приоритетом и датой создания  
  - Просмотр списка задач пользователя  
  - Редактирование и обновление информации о задаче  
  - Удаление задачи

- **Сортировка и поиск:**  
  - Сортировка задач по заголовку, статусу или дате создания  
  - Возможность выбрать топ-N самых приоритетных задач  
  - Реализация поиска по тексту заголовка и описания задач

- **Аутентификация:**  
  - Регистрация пользователя  
  - Получение JWT-токена при входе в систему  
  - Доступ к задачам только для авторизованных пользователей

- **Кэширование:**  
  - Кэширование результатов запроса задач по пользователю и параметрам запросов (сортировка, поиск, топ-N). 

    Было выбрано кешировать именно это, чтобы уменьшить количество запросов к базе данных при повторных запросах с теми же параметрами. Кэшируются данные, которые получают задачи в определённом порядке или фильтрации, что снижает нагрузку на сервер и позволяет быстрее получить результаты.

## Установка и запуск

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
2. Запустите сервер:
   ```bash
   python main.py
   ```

Сервер будет доступен по адресу http://localhost:8000.

## Запуск через Docker Compose

1. Соберите и запустите контейнеры:
   ```bash
   docker-compose up --build
   ```
2. Приложение будет доступно по адресу http://localhost:8000.


## Тестирование

### Запуск тестов
Для запуска тестов выполните команду:
```bash
pytest
```

### Запуск тестов с подробным выводом
Чтобы увидеть подробный вывод тестов, выполните:
```bash
pytest -v
```

### Генерация отчета о покрытии кода
Для проверки покрытия кода выполните:
```bash
pytest --cov=app --cov-report=html
```
После выполнения команды будет создана папка `htmlcov`, содержащая файл `index.html`. Откройте этот файл в браузере, чтобы увидеть визуализацию покрытия кода.

### Нагрузочное тестирование (Locust)

Для запуска нагрузочного тестирования с использованием Locust:

1.  Убедитесь, что ваше FastAPI приложение запущено.
2.  Выполните команду в терминале из корневой папки проекта:
    ```bash
    locust -f tests/locustfile.py
    ```
3.  Откройте браузер и перейдите по адресу, указанному Locust (обычно `http://localhost:8089`).
4.  В веб-интерфейсе Locust:
    *   Укажите количество пользователей для симуляции 
    *   Укажите скорость появления новых пользователей 
    *   В поле `Host` укажите адрес вашего запущенного приложения .
    *   Нажмите "Start".
5.  Locust начнет отправлять запросы к приложению. Можно наблюдать за статистикой в реальном времени.
6.  **Результаты нагрузочного тестирования:**
    *   Результаты отображаются в веб-интерфейсе Locust.
    *   Вы можете скачать отчеты о статистике и графиках непосредственно из интерфейса Locust (обычно в форматах CSV), либо download reports.


## Структура проекта

```
Fastapi_HW\
├── main.py                 # Запуск приложения
├── README.md               
├── requirements.txt        
├── .gitignore              
├── Dockerfile              
├── docker-compose.yml      
├── coverage.svg            # Резльутат покрытия кода
├── .coveragerc             # Конфигурация для покрытия кода
├── .github\
│   └── workflows\
│       └── ci.yml          # CI/CD конфигурация для GitHub Actions
└── app\
   ├── __init__.py          # Инициализация пакета
   ├── app.py               # FastAPI-приложение и маршруты
   ├── models.py            # SQLAlchemy модели
   ├── schemas.py           # Pydantic-схемы
   ├── database.py          # Настройка базы данных
   └── auth.py              # Аутентификация и шифрование
└── tests\
   ├── conftest.py          # Фикстуры для тестов
   ├── locustfile.py        # Сценарии нагрузочного тестирования
   ├── test_api_tasks.py    # Тесты для задач (CRUD, сортировка, поиск)
   ├── test_api_users.py    # Тесты для пользователей (регистрация, авторизация)
   ├── test_auth.py         # Тесты для аутентификации (хэширование паролей, токены)
   ├── test_cache.py        # Тесты для кэширования (генерация ключей, установка, удаление)
```